name = "omg-saas"
main = "src/worker.ts"
compatibility_date = "2026-01-17"

# Custom domain routes
routes = [
  { pattern = "api.pyro1121.com/*", zone_name = "pyro1121.com" }
]

[[d1_databases]]
binding = "DB"
database_name = "omg-licensing"
database_id = "bcaf7781-a747-4637-92d9-94782e4fa1db"

[ai]
binding = "AI"

# Rate limiting for admin API (100 requests per minute per user)
[[ratelimits]]
name = "ADMIN_RATE_LIMITER"
namespace_id = "1001"
simple = { limit = 100, period = 60 }

# Rate limiting for auth API (10 requests per minute per IP - brute force protection)
[[ratelimits]]
name = "AUTH_RATE_LIMITER"
namespace_id = "1002"
simple = { limit = 10, period = 60 }

# Rate limiting for general API (1000 requests per minute per user)
[[ratelimits]]
name = "API_RATE_LIMITER"
namespace_id = "1003"
simple = { limit = 1000, period = 60 }

# Secrets are set via: bunx wrangler secret put <NAME>
# Required: STRIPE_SECRET_KEY, STRIPE_WEBHOOK_SECRET, JWT_SECRET, ADMIN_USER_ID, RESEND_API_KEY
